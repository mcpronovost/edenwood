import{j as e,u as p,a as E,b as N,r as x,E as g,c as k,d as S}from"./index-BMNmMB4z.js";import{E as $,a as y}from"./Card-Bf25l7sK.js";function A({children:r,onSubmit:s,isLoading:i,...a}){const t=d=>{d.preventDefault(),s&&!i&&s(d)};return e.jsx("form",{className:"edw-form",onSubmit:t,disabled:i,...a,children:r})}function b({label:r,name:s,type:i="text",options:a=[],defaultValue:t,required:d=!1,onChange:o,hasError:m,block:c=!1,...f}){return e.jsxs("div",{className:`edw-form-field ${c?"edw-form-field--block":""}`,...f,children:[e.jsxs("label",{className:"edw-form-field-label",htmlFor:`field-${s}`,children:[r,d&&e.jsx("span",{className:"edw-form-field-required",children:"*"})]}),e.jsxs("div",{className:"edw-form-field-input",children:[i==="textarea"?e.jsx("textarea",{id:`field-${s}`,name:s,defaultValue:t,onChange:o,rows:6,required:d}):i==="select"?e.jsx("select",{id:`field-${s}`,name:s,defaultValue:t,onChange:o,required:d,children:a.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))}):i==="radio"?e.jsx("div",{className:"edw-form-field-input-radio",children:a.map(n=>e.jsxs("label",{className:"edw-form-field-input-radio-label",children:[e.jsx("input",{type:"radio",name:s,value:n.value,onChange:o,required:d,checked:t===n.value}),e.jsx("span",{className:"edw-form-field-input-radio-label-btn",children:n.label})]},n.value))}):e.jsx("input",{type:i,id:`field-${s}`,name:s,defaultValue:t,onChange:o,required:d,autoComplete:"off"}),m&&e.jsx("p",{className:"edw-form-field-error",children:m})]})]})}function F({hasError:r}){const{t:s}=p();return e.jsx("div",{className:"edw-form-message",children:r&&e.jsx($,{title:"Error",message:r||s("An error occurred"),variant:"danger"})})}const U=r=>{if(r.trim()){if(!/^[a-zA-Z0-9_]{3,32}$/.test(r))return"Username must be 3-32 characters, alphanumeric and underscores only"}else return"Username is required";return null},P=r=>{if(r){if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&:;.,])[a-zA-Z\d@$!%*?&:;.,]{8,}$/.test(r))return"Password must be at least 8 characters with 1 uppercase, 1 lowercase, 1 number, and 1 special character"}else return"Password is required";return null};function L(){const{setUser:r,setRat:s}=E(),{n:i}=N(),{t:a}=p(),[t,d]=x.useState({username:"",password:""}),[o,m]=x.useState(!1),[c,f]=x.useState(null),n=()=>{const u={},l=U(t.username),h=P(t.password);return l&&(u.username=l),h&&(u.password=h),f({fields:u}),Object.keys(u).length===0},j=u=>{const{name:l,value:h}=u.target;d(w=>({...w,[l]:h})),c?.fields?.[l]&&f(w=>({...w,fields:{...w.fields,[l]:""}}))},v=async u=>{if(m(!0),f(null),!n()){m(!1);return}try{const l=await S.login(t);if(l.token)s(l.token),r(l.user),i("home");else throw new Error}catch(l){f(l.error||a("An error occurred"))}finally{m(!1)}};return e.jsx("section",{className:"edw-page edw-auth",children:e.jsxs("div",{className:"edw-auth-container",children:[e.jsxs("div",{className:"edw-auth-header",children:[e.jsx("h1",{className:"edw-auth-header-title",children:a("Sign in to your account")}),e.jsxs("p",{className:"edw-auth-header-subtitle",children:[a("Or")," ",e.jsx(g,{routeName:"register",className:"edw-auth-header-subtitle",children:a("create a new account")})]})]}),e.jsx(y,{children:e.jsxs(A,{className:"edw-auth-form",onSubmit:v,isLoading:o,children:[e.jsx(b,{label:a("Username"),name:"username",defaultValue:t.username,onChange:j,hasError:c?.fields?.username,required:!0,block:!0}),e.jsx(b,{label:a("Password"),name:"password",type:"password",defaultValue:t.password,onChange:j,hasError:c?.fields?.password,required:!0,block:!0}),c?.message&&e.jsx(F,{hasError:c?.message}),e.jsx("div",{className:"edw-form-actions",children:e.jsx(k,{type:"submit",color:"primary",disabled:o,block:!0,children:a(o?"Signing in...":"Sign in")})})]})})]})})}export{L as default};
